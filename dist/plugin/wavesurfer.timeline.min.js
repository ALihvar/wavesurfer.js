/*!
 * wavesurfer.js timeline plugin 6.0.4 (2022-09-28)
 * https://wavesurfer-js.org
 * @license BSD-3-Clause
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("WaveSurfer",[],t):"object"==typeof exports?exports.WaveSurfer=t():(e.WaveSurfer=e.WaveSurfer||{},e.WaveSurfer.timeline=t())}(self,(()=>(()=>{"use strict";var e={d:(t,a)=>{for(var r in a)e.o(a,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:a[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{default:()=>a});class a{static create(e){return{name:"timeline",deferInit:!(!e||!e.deferInit)&&e.deferInit,params:e,instance:a}}_onScroll=()=>{this.wrapper&&this.drawer.wrapper&&(this.wrapper.scrollLeft=this.drawer.wrapper.scrollLeft)};_onRedraw=()=>this.render();_onReady=()=>{const e=this.wavesurfer;this.drawer=e.drawer,this.pixelRatio=e.drawer.params.pixelRatio,this.maxCanvasWidth=e.drawer.maxCanvasWidth||e.drawer.width,this.maxCanvasElementWidth=e.drawer.maxCanvasElementWidth||Math.round(this.maxCanvasWidth/this.pixelRatio),e.drawer.wrapper.addEventListener("scroll",this._onScroll),e.on("redraw",this._onRedraw),e.on("zoom",this._onZoom),this.render()};_onWrapperClick=e=>{e.preventDefault();const t="offsetX"in e?e.offsetX:e.layerX;this.fireEvent("click",t/this.wrapper.scrollWidth||0)};constructor(e,t){if(this.container="string"==typeof e.container?document.querySelector(e.container):e.container,!this.container)throw new Error("No container for wavesurfer timeline");this.wavesurfer=t,this.util=t.util,this.params=Object.assign({},{height:20,notchPercentHeight:90,labelPadding:5,unlabeledNotchColor:"#c0c0c0",primaryColor:"#000",secondaryColor:"#c0c0c0",primaryFontColor:"#000",secondaryFontColor:"#000",fontFamily:"Arial",fontSize:10,duration:null,zoomDebounce:!1,formatTimeCallback:this.defaultFormatTimeCallback,timeInterval:this.defaultTimeInterval,primaryLabelInterval:this.defaultPrimaryLabelInterval,secondaryLabelInterval:this.defaultSecondaryLabelInterval,offset:0},e),this.canvases=[],this.wrapper=null,this.drawer=null,this.pixelRatio=null,this.maxCanvasWidth=null,this.maxCanvasElementWidth=null,this._onZoom=this.params.zoomDebounce?this.wavesurfer.util.debounce((()=>this.render()),this.params.zoomDebounce):()=>this.render()}init(){this.wavesurfer.isReady?this._onReady():this.wavesurfer.once("ready",this._onReady)}destroy(){this.unAll(),this.wavesurfer.un("redraw",this._onRedraw),this.wavesurfer.un("zoom",this._onZoom),this.wavesurfer.un("ready",this._onReady),this.wavesurfer.drawer.wrapper.removeEventListener("scroll",this._onScroll),this.wrapper&&this.wrapper.parentNode&&(this.wrapper.removeEventListener("click",this._onWrapperClick),this.wrapper.parentNode.removeChild(this.wrapper),this.wrapper=null)}createWrapper(){const e=this.wavesurfer.params;this.container.innerHTML="",this.wrapper=this.container.appendChild(document.createElement("timeline")),this.util.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:`${this.params.height}px`}),(e.fillParent||e.scrollParent)&&this.util.style(this.wrapper,{width:"100%",overflowX:"hidden",overflowY:"hidden"}),this.wrapper.addEventListener("click",this._onWrapperClick)}render(){this.wrapper||this.createWrapper(),this.updateCanvases(),this.updateCanvasesPositioning(),this.renderCanvases()}addCanvas(){const e=this.wrapper.appendChild(document.createElement("canvas"));this.canvases.push(e),this.util.style(e,{position:"absolute",zIndex:4})}removeCanvas(){const e=this.canvases.pop();e.parentElement.removeChild(e)}updateCanvases(){const e=Math.round(this.drawer.wrapper.scrollWidth),t=Math.ceil(e/this.maxCanvasElementWidth);for(;this.canvases.length<t;)this.addCanvas();for(;this.canvases.length>t;)this.removeCanvas()}updateCanvasesPositioning(){const e=this.canvases.length;this.canvases.forEach(((t,a)=>{const r=a===e-1?this.drawer.wrapper.scrollWidth-this.maxCanvasElementWidth*(e-1):this.maxCanvasElementWidth;t.width=r*this.pixelRatio,t.height=(this.params.height+1)*this.pixelRatio,this.util.style(t,{width:`${r}px`,height:`${this.params.height}px`,left:a*this.maxCanvasElementWidth+"px"})}))}renderCanvases(){const e=this.params.duration||this.wavesurfer.backend.getDuration();if(e<=0)return;const t=this.wavesurfer.params,a=this.params.fontSize*t.pixelRatio,r=parseInt(e,10)+1,s=t.fillParent&&!t.scrollParent?this.drawer.getWidth():this.drawer.wrapper.scrollWidth*t.pixelRatio,i=this.params.height*this.pixelRatio,n=this.params.height*(this.params.notchPercentHeight/100)*this.pixelRatio,o=s/e,l=this.params.formatTimeCallback,h=e=>"function"==typeof e?e(o):e,p=h(this.params.timeInterval),d=h(this.params.primaryLabelInterval),c=h(this.params.secondaryLabelInterval);let m,f=o*this.params.offset,u=0;const v=[],w=this.params.offset<0?r-this.params.offset:r;for(m=0;m<w/p;m++)v.push([m,u,f]),u+=p,f+=o*p;const y=e=>{v.forEach((t=>{e(t[0],t[1],t[2])}))};this.setFillStyles(this.params.primaryColor),this.setFonts(`${a}px ${this.params.fontFamily}`),this.setFillStyles(this.params.primaryFontColor),y(((e,t,a)=>{e%d==0&&(this.fillRect(a,0,1,i),this.fillText(l(t,o),a+this.params.labelPadding*this.pixelRatio,i))})),this.setFillStyles(this.params.secondaryColor),this.setFonts(`${a}px ${this.params.fontFamily}`),this.setFillStyles(this.params.secondaryFontColor),y(((e,t,a)=>{e%c==0&&(this.fillRect(a,0,1,i),this.fillText(l(t,o),a+this.params.labelPadding*this.pixelRatio,i))})),this.setFillStyles(this.params.unlabeledNotchColor),y(((e,t,a)=>{e%c!=0&&e%d!=0&&this.fillRect(a,0,1,n)}))}setFillStyles(e){this.canvases.forEach((t=>{const a=t.getContext("2d");a&&(a.fillStyle=e)}))}setFonts(e){this.canvases.forEach((t=>{const a=t.getContext("2d");a&&(a.font=e)}))}fillRect(e,t,a,r){this.canvases.forEach(((s,i)=>{const n=i*this.maxCanvasWidth,o={x1:Math.max(e,i*this.maxCanvasWidth),y1:t,x2:Math.min(e+a,i*this.maxCanvasWidth+s.width),y2:t+r};if(o.x1<o.x2){const e=s.getContext("2d");e&&e.fillRect(o.x1-n,o.y1,o.x2-o.x1,o.y2-o.y1)}}))}fillText(e,t,a){let r,s=0;this.canvases.forEach((i=>{const n=i.getContext("2d");if(n){const i=n.canvas.width;if(s>t+r)return;s+i>t&&n&&(r=n.measureText(e).width,n.fillText(e,t-s,a)),s+=i}}))}defaultFormatTimeCallback(e,t){if(e/60>1){return`${parseInt(e/60,10)}:${e=(e=parseInt(e%60,10))<10?"0"+e:e}`}return Math.round(1e3*e)/1e3}defaultTimeInterval(e){return e>=25?1:5*e>=25?5:15*e>=25?15:60*Math.ceil(.5/e)}defaultPrimaryLabelInterval(e){return e>=25?10:5*e>=25?6:4}defaultSecondaryLabelInterval(e){return e>=25?5:2}}return t})()));
//# sourceMappingURL=wavesurfer.timeline.min.js.map