{"version":3,"file":"wavesurfer.markers.js","mappings":"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","sources":["webpack://WaveSurfer/webpack/universalModuleDefinition","webpack://WaveSurfer/webpack/bootstrap","webpack://WaveSurfer/webpack/runtime/define property getters","webpack://WaveSurfer/webpack/runtime/hasOwnProperty shorthand","webpack://WaveSurfer/webpack/runtime/make namespace object","webpack://WaveSurfer/./src/plugin/markers/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"WaveSurfer\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"WaveSurfer\"] = factory();\n\telse\n\t\troot[\"WaveSurfer\"] = root[\"WaveSurfer\"] || {}, root[\"WaveSurfer\"][\"markers\"] = factory();\n})(self, () => {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\r\n * @typedef {Object} MarkerParams\r\n * @desc The parameters used to describe a marker.\r\n * @example wavesurfer.addMarker(regionParams);\r\n * @property {number} time The time to set the marker at\r\n * @property {?label} string An optional marker label\r\n * @property {?color} string Background color for marker\r\n * @property {?position} string \"top\" or \"bottom\", defaults to \"bottom\"\r\n * @property {?markerElement} element An HTML element to display instead of the default marker image\r\n * @property {?draggable} boolean Set marker as draggable, defaults to false\r\n */\r\n\r\n\r\n/**\r\n * Markers are points in time in the audio that can be jumped to.\r\n *\r\n * @implements {PluginClass}\r\n *\r\n * @example\r\n * import MarkersPlugin from 'wavesurfer.markers.js';\r\n *\r\n * // if you are using <script> tags\r\n * var MarkerPlugin = window.WaveSurfer.markers;\r\n *\r\n * // ... initialising wavesurfer with the plugin\r\n * var wavesurfer = WaveSurfer.create({\r\n *   // wavesurfer options ...\r\n *   plugins: [\r\n *     MarkersPlugin.create({\r\n *       // plugin options ...\r\n *     })\r\n *   ]\r\n * });\r\n */\r\n\r\nconst DEFAULT_FILL_COLOR = \"#D8D8D8\";\r\nconst DEFAULT_POSITION = \"bottom\";\r\n\r\nexport default class MarkersPlugin {\r\n    /**\r\n     * @typedef {Object} MarkersPluginParams\r\n     * @property {?MarkerParams[]} markers Initial set of markers\r\n     * @fires MarkersPlugin#marker-click\r\n     * @fires MarkersPlugin#marker-drag\r\n     * @fires MarkersPlugin#marker-drop\r\n     */\r\n\r\n    /**\r\n     * Markers plugin definition factory\r\n     *\r\n     * This function must be used to create a plugin definition which can be\r\n     * used by wavesurfer to correctly instantiate the plugin.\r\n     *\r\n     * @param {MarkersPluginParams} params parameters use to initialise the plugin\r\n     * @since 4.6.0\r\n     * @return {PluginDefinition} an object representing the plugin\r\n     */\r\n    static create(params) {\r\n        return {\r\n            name: 'markers',\r\n            deferInit: params && params.deferInit ? params.deferInit : false,\r\n            params: params,\r\n            staticProps: {\r\n                addMarker(options) {\r\n                    if (!this.initialisedPluginList.markers) {\r\n                        this.initPlugin('markers');\r\n                    }\r\n                    return this.markers.add(options);\r\n                },\r\n                clearMarkers() {\r\n                    this.markers && this.markers.clear();\r\n                }\r\n            },\r\n            instance: MarkersPlugin\r\n        };\r\n    }\r\n\r\n    constructor(params, ws) {\r\n        this.params = params;\r\n        this.wavesurfer = ws;\r\n        this.util = ws.util;\r\n        this.style = this.util.style;\r\n        this.markerLineWidth = 1;\r\n        this.markerWidth = 11;\r\n        this.markerHeight = 22;\r\n        this.dragging = false;\r\n\r\n\r\n        this._onResize = () => {\r\n            this._updateMarkerPositions();\r\n        };\r\n\r\n        this._onBackendCreated = () => {\r\n            this.wrapper = this.wavesurfer.drawer.wrapper;\r\n            if (this.params.markers) {\r\n                this.params.markers.forEach(marker => this.add(marker));\r\n            }\r\n            window.addEventListener('resize', this._onResize, true);\r\n            window.addEventListener('orientationchange', this._onResize, true);\r\n            this.wavesurfer.on('zoom', this._onResize);\r\n\r\n            if (!this.markers.find(marker => marker.draggable)){\r\n                return;\r\n            }\r\n\r\n            this.onMouseMove = (e) => this._onMouseMove(e);\r\n            window.addEventListener('mousemove', this.onMouseMove);\r\n\r\n            this.onMouseUp = (e) => this._onMouseUp(e);\r\n            window.addEventListener(\"mouseup\", this.onMouseUp);\r\n        };\r\n\r\n        this.markers = [];\r\n        this._onReady = () => {\r\n            this.wrapper = this.wavesurfer.drawer.wrapper;\r\n            this._updateMarkerPositions();\r\n        };\r\n    }\r\n\r\n    init() {\r\n        // Check if ws is ready\r\n        if (this.wavesurfer.isReady) {\r\n            this._onBackendCreated();\r\n            this._onReady();\r\n        } else {\r\n            this.wavesurfer.once('ready', this._onReady);\r\n            this.wavesurfer.once('backend-created', this._onBackendCreated);\r\n        }\r\n    }\r\n\r\n    destroy() {\r\n        this.wavesurfer.un('ready', this._onReady);\r\n        this.wavesurfer.un('backend-created', this._onBackendCreated);\r\n\r\n        this.wavesurfer.un('zoom', this._onResize);\r\n\r\n        window.removeEventListener('resize', this._onResize, true);\r\n        window.removeEventListener('orientationchange', this._onResize, true);\r\n\r\n        if (this.onMouseMove) {\r\n            window.removeEventListener('mousemove', this.onMouseMove);\r\n        }\r\n        if (this.onMouseUp) {\r\n            window.removeEventListener(\"mouseup\", this.onMouseUp);\r\n        }\r\n\r\n        this.clear();\r\n    }\r\n\r\n    /**\r\n     * Add a marker\r\n     *\r\n     * @param {MarkerParams} params Marker definition\r\n     * @return {object} The created marker\r\n     */\r\n    add(params) {\r\n        let marker = {\r\n            time: params.time,\r\n            label: params.label,\r\n            color: params.color || DEFAULT_FILL_COLOR,\r\n            position: params.position || DEFAULT_POSITION,\r\n            draggable: !!params.draggable\r\n        };\r\n\r\n        marker.el = this._createMarkerElement(marker, params.markerElement);\r\n\r\n        this.wrapper.appendChild(marker.el);\r\n        this.markers.push(marker);\r\n        this._updateMarkerPositions();\r\n\r\n        return marker;\r\n    }\r\n\r\n    /**\r\n     * Remove a marker\r\n     *\r\n     * @param {number} index Index of the marker to remove\r\n     */\r\n    remove(index) {\r\n        let marker = this.markers[index];\r\n        if (!marker) {\r\n            return;\r\n        }\r\n\r\n        this.wrapper.removeChild(marker.el);\r\n        this.markers.splice(index, 1);\r\n    }\r\n\r\n    _createPointerSVG(color, position) {\r\n        const svgNS = \"http://www.w3.org/2000/svg\";\r\n\r\n        const el = document.createElementNS(svgNS, \"svg\");\r\n        const polygon = document.createElementNS(svgNS, \"polygon\");\r\n\r\n        el.setAttribute(\"viewBox\", \"0 0 40 80\");\r\n\r\n        polygon.setAttribute(\"id\", \"polygon\");\r\n        polygon.setAttribute(\"stroke\", \"#979797\");\r\n        polygon.setAttribute(\"fill\", color);\r\n        polygon.setAttribute(\"points\", \"20 0 40 30 40 80 0 80 0 30\");\r\n        if ( position == \"top\" ) {\r\n            polygon.setAttribute(\"transform\", \"rotate(180, 20 40)\");\r\n        }\r\n\r\n        el.appendChild(polygon);\r\n\r\n        this.style(el, {\r\n            width: this.markerWidth + \"px\",\r\n            height: this.markerHeight + \"px\",\r\n            \"min-width\": this.markerWidth + \"px\",\r\n            \"margin-right\": \"5px\",\r\n            \"z-index\": 4\r\n        });\r\n        return el;\r\n    }\r\n\r\n    _createMarkerElement(marker, markerElement) {\r\n        let label = marker.label;\r\n\r\n        const el = document.createElement('marker');\r\n        el.className = \"wavesurfer-marker\";\r\n\r\n        this.style(el, {\r\n            position: \"absolute\",\r\n            height: \"100%\",\r\n            display: \"flex\",\r\n            overflow: \"hidden\",\r\n            \"flex-direction\": (marker.position == \"top\" ? \"column-reverse\" : \"column\")\r\n        });\r\n\r\n        const line = document.createElement('div');\r\n        const width = markerElement ? markerElement.width : this.markerWidth;\r\n        marker.offset = (width - this.markerLineWidth) / 2;\r\n        this.style(line, {\r\n            \"flex-grow\": 1,\r\n            \"margin-left\": marker.offset + \"px\",\r\n            background: \"black\",\r\n            width: this.markerLineWidth + \"px\",\r\n            opacity: 0.1\r\n        });\r\n        el.appendChild(line);\r\n\r\n        const labelDiv = document.createElement('div');\r\n        const point = markerElement || this._createPointerSVG(marker.color, marker.position);\r\n        if (marker.draggable){\r\n            point.draggable = false;\r\n        }\r\n        labelDiv.appendChild(point);\r\n\r\n        if ( label ) {\r\n            const labelEl = document.createElement('span');\r\n            labelEl.innerText = label;\r\n            this.style(labelEl, {\r\n                \"font-family\": \"monospace\",\r\n                \"font-size\": \"90%\"\r\n            });\r\n            labelDiv.appendChild(labelEl);\r\n        }\r\n\r\n        this.style(labelDiv, {\r\n            display: \"flex\",\r\n            \"align-items\": \"center\",\r\n            cursor: \"pointer\"\r\n        });\r\n\r\n        el.appendChild(labelDiv);\r\n\r\n        labelDiv.addEventListener(\"click\", e => {\r\n            e.stopPropagation();\r\n            // Click event is caught when the marker-drop event was dispatched.\r\n            // Drop event was dispatched at this moment, but this.dragging\r\n            // is waiting for the next tick to set as false\r\n            if (this.dragging){\r\n                return;\r\n            }\r\n            this.wavesurfer.setCurrentTime(marker.time);\r\n            this.wavesurfer.fireEvent(\"marker-click\", marker, e);\r\n        });\r\n\r\n        if (marker.draggable) {\r\n            labelDiv.addEventListener(\"mousedown\", e => {\r\n                this.selectedMarker = marker;\r\n            });\r\n        }\r\n        return el;\r\n    }\r\n\r\n    _updateMarkerPositions() {\r\n        for ( let i = 0 ; i < this.markers.length; i++ ) {\r\n            let marker = this.markers[i];\r\n            this._updateMarkerPosition(marker);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Update a marker position based on its time property.\r\n     *\r\n     * @private\r\n     * @param {MarkerParams} params The marker to update.\r\n     * @returns {void}\r\n     */\r\n    _updateMarkerPosition(params) {\r\n        const duration = this.wavesurfer.getDuration();\r\n        const elementWidth =\r\n            this.wavesurfer.drawer.width /\r\n            this.wavesurfer.params.pixelRatio;\r\n\r\n        const positionPct = Math.min(params.time / duration, 1);\r\n        const leftPx = ((elementWidth * positionPct) - params.offset);\r\n        this.style(params.el, {\r\n            \"left\": leftPx + \"px\",\r\n            \"max-width\": (elementWidth - leftPx) + \"px\"\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fires `marker-drag` event, update the `time` property for the\r\n     * selected marker based on the mouse position, and calls to update\r\n     * its position.\r\n     *\r\n     * @private\r\n     * @param {MouseEvent} event The mouse event.\r\n     * @returns {void}\r\n     */\r\n    _onMouseMove(event) {\r\n        if (!this.selectedMarker){\r\n            return;\r\n        }\r\n        if (!this.dragging){\r\n            this.dragging = true;\r\n            this.wavesurfer.fireEvent(\"marker-drag\", this.selectedMarker, event);\r\n        }\r\n        this.selectedMarker.time = this.wavesurfer.drawer.handleEvent(event) * this.wavesurfer.getDuration();\r\n        this._updateMarkerPositions();\r\n    }\r\n\r\n    /**\r\n     * Fires `marker-drop` event and unselect the dragged marker.\r\n     *\r\n     * @private\r\n     * @param {MouseEvent} event The mouse event.\r\n     * @returns {void}\r\n     */\r\n    _onMouseUp(event) {\r\n        if (this.selectedMarker) {\r\n            setTimeout(() => {\r\n                this.selectedMarker = false;\r\n                this.dragging = false;\r\n            }, 0);\r\n        }\r\n\r\n        if (!this.dragging) {\r\n            return;\r\n        }\r\n\r\n        event.stopPropagation();\r\n        const duration = this.wavesurfer.getDuration();\r\n        this.selectedMarker.time = this.wavesurfer.drawer.handleEvent(event) * duration;\r\n        this._updateMarkerPositions();\r\n        this.wavesurfer.fireEvent(\"marker-drop\", this.selectedMarker, event);\r\n    }\r\n\r\n    /**\r\n     * Remove all markers\r\n     */\r\n    clear() {\r\n        while ( this.markers.length > 0 ) {\r\n            this.remove(0);\r\n        }\r\n    }\r\n}\r\n"],"names":["DEFAULT_FILL_COLOR","DEFAULT_POSITION","MarkersPlugin","create","params","name","deferInit","staticProps","addMarker","options","initialisedPluginList","markers","initPlugin","add","clearMarkers","clear","instance","constructor","ws","wavesurfer","util","style","markerLineWidth","markerWidth","markerHeight","dragging","_onResize","_updateMarkerPositions","_onBackendCreated","wrapper","drawer","forEach","marker","window","addEventListener","on","find","draggable","onMouseMove","e","_onMouseMove","onMouseUp","_onMouseUp","_onReady","init","isReady","once","destroy","un","removeEventListener","time","label","color","position","el","_createMarkerElement","markerElement","appendChild","push","remove","index","removeChild","splice","_createPointerSVG","svgNS","document","createElementNS","polygon","setAttribute","width","height","createElement","className","display","overflow","line","offset","background","opacity","labelDiv","point","labelEl","innerText","cursor","stopPropagation","setCurrentTime","fireEvent","selectedMarker","i","length","_updateMarkerPosition","duration","getDuration","elementWidth","pixelRatio","positionPct","Math","min","leftPx","event","handleEvent","setTimeout"],"sourceRoot":""}