{"version":3,"file":"wavesurfer.playhead.js","mappings":"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","sources":["webpack://WaveSurfer/webpack/universalModuleDefinition","webpack://WaveSurfer/webpack/bootstrap","webpack://WaveSurfer/webpack/runtime/define property getters","webpack://WaveSurfer/webpack/runtime/hasOwnProperty shorthand","webpack://WaveSurfer/webpack/runtime/make namespace object","webpack://WaveSurfer/./src/plugin/playhead/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"WaveSurfer\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"WaveSurfer\"] = factory();\n\telse\n\t\troot[\"WaveSurfer\"] = root[\"WaveSurfer\"] || {}, root[\"WaveSurfer\"][\"playhead\"] = factory();\n})(self, () => {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","\r\n/**\r\n * The playhead plugin separates the notion of the currently playing position from\r\n * a 'play-start' position.  Having a playhead enables a listening pattern\r\n * (commonly found in DAWs) that involves listening to a section of a track\r\n * repeatedly, rather than listening to an entire track in a linear fashion.\r\n *\r\n * @implements {PluginClass}\r\n *\r\n * @example\r\n * import PlayheadPlugin from 'wavesurfer.playhead.js';\r\n *\r\n * // if you are using <script> tags\r\n * var PlayheadPlugin = window.WaveSurfer.playhead;\r\n *\r\n * // ... initialising wavesurfer with the plugin\r\n * var wavesurfer = WaveSurfer.create({\r\n *   // wavesurfer options ...\r\n *   plugins: [\r\n *     PlayheadPlugin.create({\r\n *        movePlayheadOnSeek: true,\r\n *        drawPlayhead: false,\r\n *        movePlayheadOnPause: false\r\n *     })\r\n *   ]\r\n * });\r\n */\r\n\r\nconst DEFAULT_FILL_COLOR = '#CF2F00';\r\n\r\nexport default class PlayheadPlugin {\r\n    /**\r\n     * @typedef {Object} PlayheadPluginParams\r\n     * @property {?boolean} draw=true Draw the playhead as a triangle/line\r\n     * @property {?boolean} moveOnSeek=true Seeking (via clicking) while playing moves the playhead\r\n     * @property {?boolean} returnOnPause=true Pausing the track returns the seek position to the playhead\r\n     */\r\n\r\n    /**\r\n     * Playhead plugin definition factory\r\n     *\r\n     * This function must be used to create a plugin definition which can be\r\n     * used by wavesurfer to correctly instantiate the plugin.\r\n     *\r\n     * @param {PlayheadPluginParams} params parameters use to initialise the plugin\r\n     * @since 5.0.0\r\n     * @return {PluginDefinition} an object representing the plugin\r\n     */\r\n    static create(params) {\r\n        return {\r\n            name: 'playhead',\r\n            deferInit: params && params.deferInit ? params.deferInit : false,\r\n            params: params,\r\n            instance: PlayheadPlugin\r\n        };\r\n    }\r\n\r\n    constructor(params, ws) {\r\n        this.params = params;\r\n        this.options = {};\r\n\r\n        ['draw', 'moveOnSeek', 'returnOnPause'].forEach(opt => {\r\n            if (opt in params) {\r\n                this.options[opt] = params[opt];\r\n            } else {\r\n                this.options[opt] = true;\r\n            }\r\n        });\r\n\r\n\r\n        this.wavesurfer = ws;\r\n        this.util = ws.util;\r\n        this.style = this.util.style;\r\n        this.markerWidth = 21;\r\n        this.markerHeight = 16;\r\n        this.playheadTime = 0;\r\n        this.unFuns = [];\r\n\r\n        this._onResize = () => {\r\n            this._updatePlayheadPosition();\r\n        };\r\n\r\n        this._onReady = () => {\r\n            this.wrapper = this.wavesurfer.drawer.wrapper;\r\n            this._updatePlayheadPosition();\r\n        };\r\n    }\r\n\r\n    _onBackendCreated() {\r\n        this.wrapper = this.wavesurfer.drawer.wrapper;\r\n\r\n        if (this.options.draw) {\r\n            this._createPlayheadElement();\r\n            window.addEventListener('resize', this._onResize, true);\r\n            window.addEventListener('orientationchange', this._onResize, true);\r\n\r\n            this.wavesurferOn('zoom', this._onResize);\r\n        }\r\n\r\n        this.wavesurferOn('pause', () => {\r\n            if ( this.options.returnOnPause ) {\r\n                this.wavesurfer.setCurrentTime(this.playheadTime);\r\n            }\r\n        });\r\n\r\n        this.wavesurferOn('seek', () => {\r\n            if ( this.options.moveOnSeek ) {\r\n                this.playheadTime = this.wavesurfer.getCurrentTime();\r\n                this._updatePlayheadPosition();\r\n            }\r\n        });\r\n\r\n        this.playheadTime = this.wavesurfer.getCurrentTime();\r\n    }\r\n\r\n    wavesurferOn(ev, fn) {\r\n        let ret = this.wavesurfer.on(ev, fn);\r\n        this.unFuns.push(() => {\r\n            this.wavesurfer.un(ev, fn);\r\n        });\r\n        return ret;\r\n    }\r\n\r\n    init() {\r\n        if (this.wavesurfer.isReady) {\r\n            this._onBackendCreated();\r\n            this._onReady();\r\n        } else {\r\n            let r;\r\n\r\n            this.wavesurfer.once('ready', () => this._onReady());\r\n            this.wavesurfer.once('backend-created', () => this._onBackendCreated());\r\n        }\r\n    }\r\n\r\n    destroy() {\r\n        this.unFuns.forEach(f => f());\r\n        this.unFuns = [];\r\n\r\n        this.wrapper.removeChild(this.element);\r\n\r\n        window.removeEventListener('resize', this._onResize, true);\r\n        window.removeEventListener('orientationchange', this._onResize, true);\r\n    }\r\n\r\n    setPlayheadTime(time) {\r\n        this.playheadTime = time;\r\n\r\n        if (!this.wavesurfer.isPlaying()) {\r\n            this.wavesurfer.setCurrentTime(time);\r\n        }\r\n        this._updatePlayheadPosition();\r\n    }\r\n\r\n    _createPointerSVG() {\r\n        const svgNS = 'http://www.w3.org/2000/svg';\r\n\r\n        const el = document.createElementNS(svgNS, 'svg');\r\n        const path = document.createElementNS(svgNS, 'path');\r\n\r\n        el.setAttribute('viewBox', '0 0 33 30');\r\n        path.setAttribute('d', 'M16.75 31 31.705 5.566A3 3 0 0 0 29.146 1H4.354a3 3 0 0 0-2.56 4.566L16.75 31z');\r\n        path.setAttribute('stroke', '#979797');\r\n        path.setAttribute('fill', DEFAULT_FILL_COLOR);\r\n\r\n        el.appendChild(path);\r\n\r\n        this.style(el, {\r\n            width: this.markerWidth + 'px',\r\n            height: this.markerHeight + 'px',\r\n            cursor: 'pointer',\r\n            'z-index': 5\r\n        });\r\n        return el;\r\n    }\r\n\r\n    _createPlayheadElement() {\r\n        const el = document.createElement('playhead');\r\n        el.className = 'wavesurfer-playhead';\r\n\r\n        this.style(el, {\r\n            position: 'absolute',\r\n            height: '100%',\r\n            display: 'flex',\r\n            'flex-direction': 'column'\r\n        });\r\n\r\n        const pointer = this._createPointerSVG();\r\n        el.appendChild(pointer);\r\n\r\n        pointer.addEventListener('click', e => {\r\n            e.stopPropagation();\r\n            this.wavesurfer.setCurrentTime(this.playheadTime);\r\n        });\r\n\r\n        const line = document.createElement('div');\r\n        this.style(line, {\r\n            'flex-grow': 1,\r\n            'margin-left': (this.markerWidth / 2 - 0.5) + 'px',\r\n            background: 'black',\r\n            width: '1px',\r\n            opacity: 0.1\r\n        });\r\n\r\n        el.appendChild(line);\r\n\r\n        this.element = el;\r\n        this.wrapper.appendChild(el);\r\n    }\r\n\r\n    _updatePlayheadPosition() {\r\n        if (!this.element) {\r\n            return;\r\n        }\r\n\r\n        const duration = this.wavesurfer.getDuration();\r\n        const elementWidth =\r\n            this.wavesurfer.drawer.width /\r\n            this.wavesurfer.params.pixelRatio;\r\n\r\n        const positionPct = this.playheadTime / duration;\r\n        this.style(this.element, {\r\n            left: ((elementWidth * positionPct) - (this.markerWidth / 2)) + 'px'\r\n        });\r\n    }\r\n}\r\n"],"names":["DEFAULT_FILL_COLOR","PlayheadPlugin","create","params","name","deferInit","instance","constructor","ws","options","forEach","opt","wavesurfer","util","style","markerWidth","markerHeight","playheadTime","unFuns","_onResize","_updatePlayheadPosition","_onReady","wrapper","drawer","_onBackendCreated","draw","_createPlayheadElement","window","addEventListener","wavesurferOn","returnOnPause","setCurrentTime","moveOnSeek","getCurrentTime","ev","fn","ret","on","push","un","init","isReady","r","once","destroy","f","removeChild","element","removeEventListener","setPlayheadTime","time","isPlaying","_createPointerSVG","svgNS","el","document","createElementNS","path","setAttribute","appendChild","width","height","cursor","createElement","className","position","display","pointer","e","stopPropagation","line","background","opacity","duration","getDuration","elementWidth","pixelRatio","positionPct","left"],"sourceRoot":""}