{"version":3,"file":"wavesurfer.regions.js","mappings":"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AW,GAAG,MAAd;IACD;;IAED,KAAK5I,YAAL,IAAqB,KAAKrB,KAAL,CAAW,KAAKqB,YAAhB,EAA8B;MAAEuD,MAAM,EAAEqF;IAAV,CAA9B,CAArB;IACA,KAAK3I,aAAL,IACE,KAAKtB,KAAL,CAAW,KAAKsB,aAAhB,EAA+B;MAAEsD,MAAM,EAAEqF;IAAV,CAA/B,CADF;EAED;;AAhzBiB;;;;;;UCVpB;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACe,MAAMC,aAAN,CAAoB;EAC/B;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACiB,OAANC,MAAM,CAAC1K,MAAD,EAAS;IAClB,OAAO;MACH2K,IAAI,EAAE,SADH;MAEHC,SAAS,EAAE5K,MAAM,IAAIA,MAAM,CAAC4K,SAAjB,GAA6B5K,MAAM,CAAC4K,SAApC,GAAgD,KAFxD;MAGH5K,MAAM,EAAEA,MAHL;MAIH6K,WAAW,EAAE;QACTC,SAAS,CAACC,OAAD,EAAU;UACf,IAAI,CAAC,KAAKC,qBAAL,CAA2BnI,OAAhC,EAAyC;YACrC,KAAKoI,UAAL,CAAgB,SAAhB;UACH;;UACD,OAAO,KAAKpI,OAAL,CAAaqI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","sources":["webpack://WaveSurfer/webpack/universalModuleDefinition","webpack://WaveSurfer/./src/plugin/regions/region.js","webpack://WaveSurfer/webpack/bootstrap","webpack://WaveSurfer/webpack/runtime/define property getters","webpack://WaveSurfer/webpack/runtime/hasOwnProperty shorthand","webpack://WaveSurfer/webpack/runtime/make namespace object","webpack://WaveSurfer/./src/plugin/regions/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"WaveSurfer\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"WaveSurfer\"] = factory();\n\telse\n\t\troot[\"WaveSurfer\"] = root[\"WaveSurfer\"] || {}, root[\"WaveSurfer\"][\"regions\"] = factory();\n})(self, () => {\nreturn ","/**\r\n *  @since 4.0.0\r\n *\r\n * (Single) Region plugin class\r\n *\r\n * Must be turned into an observer before instantiating. This is done in\r\n * `RegionsPlugin` (main plugin class).\r\n *\r\n * @extends {Observer}\r\n */\r\nexport class Region {\r\n  constructor(params, regionsUtils, ws) {\r\n    this.wavesurfer = ws;\r\n    this.wrapper = ws.drawer.wrapper;\r\n    this.util = ws.util;\r\n    this.style = this.util.style;\r\n    this.regionsUtil = regionsUtils;\r\n    this.vertical = ws.drawer.params.vertical;\r\n\r\n    this.id = params.id == null ? ws.util.getId() : params.id;\r\n    this.start = Number(params.start) || 0;\r\n    this.end =\r\n      params.end == null\r\n        ? // small marker-like region\r\n          this.start +\r\n          (4 / this.wrapper.scrollWidth) * this.wavesurfer.getDuration()\r\n        : Number(params.end);\r\n    this.resize = params.resize === undefined ? true : Boolean(params.resize);\r\n    this.drag = params.drag === undefined ? true : Boolean(params.drag);\r\n    // reflect resize and drag state of region for region-updated listener\r\n    this.isResizing = false;\r\n    this.isDragging = false;\r\n    this.loop = Boolean(params.loop);\r\n    this.color = params.color || 'rgba(0, 0, 0, 0.1)';\r\n    // The left and right handleStyle properties can be set to 'none' for\r\n    // no styling or can be assigned an object containing CSS properties.\r\n    this.handleStyle = params.handleStyle || {\r\n      left: {},\r\n      right: {},\r\n    };\r\n    this.handleLeftEl = null;\r\n    this.handleRightEl = null;\r\n    this.data = params.data || {};\r\n    this.attributes = params.attributes || {};\r\n    this.showTooltip = params.showTooltip || true;\r\n\r\n    this.maxLength = params.maxLength;\r\n    // It assumes the minLength parameter value, or the regionsMinLength parameter value, if the first one not provided\r\n    this.minLength = params.minLength;\r\n    this._onRedraw = () => this.updateRender();\r\n\r\n    this.scroll = params.scroll !== false && ws.params.scrollParent;\r\n    this.scrollSpeed = params.scrollSpeed || 1;\r\n    this.scrollThreshold = params.scrollThreshold || 10;\r\n    // Determines whether the context menu is prevented from being opened.\r\n    this.preventContextMenu =\r\n      params.preventContextMenu === undefined\r\n        ? false\r\n        : Boolean(params.preventContextMenu);\r\n\r\n    // select channel ID to set region\r\n    let channelIdx =\r\n      params.channelIdx == null ? -1 : parseInt(params.channelIdx);\r\n\r\n    let channelCount =\r\n      ws.regions.params.channelCount && ws.params.splitChannels\r\n        ? ws.regions.params.channelCount\r\n        : -1;\r\n\r\n    if (channelIdx >= ws.regions.params.channelCount) {\r\n      this.regionHeight = '0%';\r\n      return;\r\n    }\r\n    this.channelIdx = channelIdx;\r\n    this.regionHeight = '100%';\r\n    this.marginTop = '0px';\r\n\r\n    if (channelIdx !== -1) {\r\n      if (channelCount >= 0) {\r\n        this.regionHeight = Math.floor((1 / channelCount) * 100) + '%';\r\n        this.marginTop = this.wavesurfer.getHeight() * channelIdx + 'px';\r\n      }\r\n    }\r\n\r\n    this.formatTimeCallback = params.formatTimeCallback;\r\n    this.edgeScrollWidth = params.edgeScrollWidth;\r\n    this.bindInOut();\r\n    this.render();\r\n    this.wavesurfer.on('zoom', this._onRedraw);\r\n    this.wavesurfer.on('redraw', this._onRedraw);\r\n    this.wavesurfer.fireEvent('region-created', this);\r\n  }\r\n\r\n  /* Update region params. */\r\n  update(params, eventParams) {\r\n    if (params.start != null) {\r\n      this.start = Number(params.start);\r\n    }\r\n    if (params.end != null) {\r\n      this.end = Number(params.end);\r\n    }\r\n    if (params.loop != null) {\r\n      this.loop = Boolean(params.loop);\r\n    }\r\n    if (params.color != null) {\r\n      this.color = params.color;\r\n    }\r\n    if (params.handleStyle != null) {\r\n      this.handleStyle = params.handleStyle;\r\n    }\r\n    if (params.data != null) {\r\n      this.data = params.data;\r\n    }\r\n    if (params.resize != null) {\r\n      this.resize = Boolean(params.resize);\r\n      this.updateHandlesResize(this.resize);\r\n    }\r\n    if (params.drag != null) {\r\n      this.drag = Boolean(params.drag);\r\n    }\r\n    if (params.maxLength != null) {\r\n      this.maxLength = Number(params.maxLength);\r\n    }\r\n    if (params.minLength != null) {\r\n      this.minLength = Number(params.minLength);\r\n    }\r\n    if (params.attributes != null) {\r\n      this.attributes = params.attributes;\r\n    }\r\n\r\n    this.updateRender();\r\n    this.fireEvent('update');\r\n    this.wavesurfer.fireEvent('region-updated', this, eventParams);\r\n  }\r\n\r\n  /* Remove a single region. */\r\n  remove() {\r\n    if (this.element) {\r\n      this.wrapper.removeChild(this.element.domElement);\r\n      this.element = null;\r\n      this.fireEvent('remove');\r\n      this.wavesurfer.un('zoom', this._onRedraw);\r\n      this.wavesurfer.un('redraw', this._onRedraw);\r\n      this.wavesurfer.fireEvent('region-removed', this);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Play the audio region.\r\n   * @param {number} start Optional offset to start playing at\r\n   */\r\n  play(start) {\r\n    const s = start || this.start;\r\n    this.wavesurfer.play(s, this.end);\r\n    this.fireEvent('play');\r\n    this.wavesurfer.fireEvent('region-play', this);\r\n  }\r\n\r\n  /**\r\n   * Play the audio region in a loop.\r\n   * @param {number} start Optional offset to start playing at\r\n   * */\r\n  playLoop(start) {\r\n    this.loop = true;\r\n    this.play(start);\r\n  }\r\n\r\n  /**\r\n   * Set looping on/off.\r\n   * @param {boolean} loop True if should play in loop\r\n   */\r\n  setLoop(loop) {\r\n    this.loop = loop;\r\n  }\r\n\r\n  /* Render a region as a DOM element. */\r\n  render() {\r\n    this.element = this.util.withOrientation(\r\n      this.wrapper.appendChild(document.createElement('region')),\r\n      this.vertical\r\n    );\r\n\r\n    this.element.className = 'wavesurfer-region';\r\n    if (this.showTooltip) {\r\n      this.element.title = this.formatTime(this.start, this.end);\r\n    }\r\n    this.element.setAttribute('data-id', this.id);\r\n\r\n    for (const attrname in this.attributes) {\r\n      this.element.setAttribute(\r\n        'data-region-' + attrname,\r\n        this.attributes[attrname]\r\n      );\r\n    }\r\n\r\n    this.style(this.element, {\r\n      position: 'absolute',\r\n      height: this.regionHeight,\r\n      top: this.marginTop,\r\n    });\r\n\r\n    /* Resize handles */\r\n    if (this.resize) {\r\n      this.handleLeftEl = this.util.withOrientation(\r\n        this.element.appendChild(document.createElement('handle')),\r\n        this.vertical\r\n      );\r\n      this.handleRightEl = this.util.withOrientation(\r\n        this.element.appendChild(document.createElement('handle')),\r\n        this.vertical\r\n      );\r\n\r\n      this.handleLeftEl.className = 'wavesurfer-handle wavesurfer-handle-start';\r\n      this.handleRightEl.className = 'wavesurfer-handle wavesurfer-handle-end';\r\n\r\n      // Default CSS properties for both handles.\r\n      const css = {\r\n        cursor: this.vertical ? 'row-resize' : 'col-resize',\r\n        position: 'absolute',\r\n        top: '0px',\r\n        width: '2px',\r\n        height: '100%',\r\n        backgroundColor: 'rgba(0, 0, 0, 1)',\r\n      };\r\n\r\n      // Merge CSS properties per handle.\r\n      const handleLeftCss =\r\n        this.handleStyle.left !== 'none'\r\n          ? Object.assign({ left: '0px' }, css, this.handleStyle.left)\r\n          : null;\r\n      const handleRightCss =\r\n        this.handleStyle.right !== 'none'\r\n          ? Object.assign({ right: '0px' }, css, this.handleStyle.right)\r\n          : null;\r\n\r\n      if (handleLeftCss) {\r\n        this.style(this.handleLeftEl, handleLeftCss);\r\n      }\r\n\r\n      if (handleRightCss) {\r\n        this.style(this.handleRightEl, handleRightCss);\r\n      }\r\n    }\r\n\r\n    this.updateRender();\r\n    this.bindEvents();\r\n  }\r\n\r\n  formatTime(start, end) {\r\n    if (this.formatTimeCallback) {\r\n      return this.formatTimeCallback(start, end);\r\n    }\r\n    return (start == end ? [start] : [start, end])\r\n      .map((time) =>\r\n        [\r\n          Math.floor((time % 3600) / 60), // minutes\r\n          ('00' + Math.floor(time % 60)).slice(-2), // seconds\r\n        ].join(':')\r\n      )\r\n      .join('-');\r\n  }\r\n\r\n  getWidth() {\r\n    return this.wavesurfer.drawer.width / this.wavesurfer.params.pixelRatio;\r\n  }\r\n\r\n  /* Update element's position, width, color. */\r\n  updateRender() {\r\n    // duration varies during loading process, so don't overwrite important data\r\n    const dur = this.wavesurfer.getDuration();\r\n    const width = this.getWidth();\r\n\r\n    let startLimited = this.start;\r\n    let endLimited = this.end;\r\n    if (startLimited < 0) {\r\n      startLimited = 0;\r\n      endLimited = endLimited - startLimited;\r\n    }\r\n    if (endLimited > dur) {\r\n      endLimited = dur;\r\n      startLimited = dur - (endLimited - startLimited);\r\n    }\r\n\r\n    if (this.minLength != null) {\r\n      endLimited = Math.max(startLimited + this.minLength, endLimited);\r\n    }\r\n\r\n    if (this.maxLength != null) {\r\n      endLimited = Math.min(startLimited + this.maxLength, endLimited);\r\n    }\r\n\r\n    if (this.element != null) {\r\n      // Calculate the left and width values of the region such that\r\n      // no gaps appear between regions.\r\n      const left = Math.round((startLimited / dur) * width);\r\n      const regionWidth = Math.round((endLimited / dur) * width) - left;\r\n\r\n      this.style(this.element, {\r\n        left: left + 'px',\r\n        width: regionWidth + 'px',\r\n        backgroundColor: this.color,\r\n        cursor: this.drag ? 'move' : 'default',\r\n      });\r\n\r\n      for (const attrname in this.attributes) {\r\n        this.element.setAttribute(\r\n          'data-region-' + attrname,\r\n          this.attributes[attrname]\r\n        );\r\n      }\r\n\r\n      if (this.showTooltip) {\r\n        this.element.title = this.formatTime(this.start, this.end);\r\n      }\r\n    }\r\n  }\r\n\r\n  /* Bind audio events. */\r\n  bindInOut() {\r\n    this.firedIn = false;\r\n    this.firedOut = false;\r\n\r\n    const onProcess = (time) => {\r\n      let start = Math.round(this.start * 10) / 10;\r\n      let end = Math.round(this.end * 10) / 10;\r\n      time = Math.round(time * 10) / 10;\r\n\r\n      if (!this.firedOut && this.firedIn && (start > time || end <= time)) {\r\n        this.firedOut = true;\r\n        this.firedIn = false;\r\n        this.fireEvent('out');\r\n        this.wavesurfer.fireEvent('region-out', this);\r\n      }\r\n      if (!this.firedIn && start <= time && end > time) {\r\n        this.firedIn = true;\r\n        this.firedOut = false;\r\n        this.fireEvent('in');\r\n        this.wavesurfer.fireEvent('region-in', this);\r\n      }\r\n    };\r\n\r\n    this.wavesurfer.backend.on('audioprocess', onProcess);\r\n\r\n    this.on('remove', () => {\r\n      this.wavesurfer.backend.un('audioprocess', onProcess);\r\n    });\r\n\r\n    /* Loop playback. */\r\n    this.on('out', () => {\r\n      if (this.loop) {\r\n        const realTime = this.wavesurfer.getCurrentTime();\r\n        if (realTime >= this.start && realTime <= this.end) {\r\n          this.wavesurfer.play(this.start);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /* Bind DOM events. */\r\n  bindEvents() {\r\n    const preventContextMenu = this.preventContextMenu;\r\n\r\n    this.element.addEventListener('mouseenter', (e) => {\r\n      this.fireEvent('mouseenter', e);\r\n      this.wavesurfer.fireEvent('region-mouseenter', this, e);\r\n    });\r\n\r\n    this.element.addEventListener('mouseleave', (e) => {\r\n      this.fireEvent('mouseleave', e);\r\n      this.wavesurfer.fireEvent('region-mouseleave', this, e);\r\n    });\r\n\r\n    this.element.addEventListener('click', (e) => {\r\n      e.preventDefault();\r\n      this.fireEvent('click', e);\r\n      this.wavesurfer.fireEvent('region-click', this, e);\r\n    });\r\n\r\n    this.element.addEventListener('dblclick', (e) => {\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n      this.fireEvent('dblclick', e);\r\n      this.wavesurfer.fireEvent('region-dblclick', this, e);\r\n    });\r\n\r\n    this.element.addEventListener('contextmenu', (e) => {\r\n      if (preventContextMenu) {\r\n        e.preventDefault();\r\n      }\r\n      this.fireEvent('contextmenu', e);\r\n      this.wavesurfer.fireEvent('region-contextmenu', this, e);\r\n    });\r\n\r\n    /* Drag or resize on mousemove. */\r\n    if (this.drag || this.resize) {\r\n      this.bindDragEvents();\r\n    }\r\n  }\r\n\r\n  bindDragEvents() {\r\n    const container = this.wavesurfer.drawer.container;\r\n    const scrollSpeed = this.scrollSpeed;\r\n    const scrollThreshold = this.scrollThreshold;\r\n    let startTime;\r\n    let touchId;\r\n    let drag;\r\n    let maxScroll;\r\n    let resize;\r\n    let updated = false;\r\n    let scrollDirection;\r\n    let wrapperRect;\r\n    let regionLeftHalfTime;\r\n    let regionRightHalfTime;\r\n\r\n    // Scroll when the user is dragging within the threshold\r\n    const edgeScroll = (event) => {\r\n      let orientedEvent = this.util.withOrientation(event, this.vertical);\r\n      const duration = this.wavesurfer.getDuration();\r\n      if (!scrollDirection || (!drag && !resize)) {\r\n        return;\r\n      }\r\n\r\n      const x = orientedEvent.clientX;\r\n      let distanceBetweenCursorAndWrapperEdge = 0;\r\n      let regionHalfTimeWidth = 0;\r\n      let adjustment = 0;\r\n\r\n      // Get the currently selected time according to the mouse position\r\n      let time = this.regionsUtil.getRegionSnapToGridValue(\r\n        this.wavesurfer.drawer.handleEvent(event) * duration\r\n      );\r\n\r\n      if (drag) {\r\n        // Considering the point of contact with the region while edgescrolling\r\n        if (scrollDirection === -1) {\r\n          regionHalfTimeWidth =\r\n            regionLeftHalfTime * this.wavesurfer.params.minPxPerSec;\r\n          distanceBetweenCursorAndWrapperEdge = x - wrapperRect.left;\r\n        } else {\r\n          regionHalfTimeWidth =\r\n            regionRightHalfTime * this.wavesurfer.params.minPxPerSec;\r\n          distanceBetweenCursorAndWrapperEdge = wrapperRect.right - x;\r\n        }\r\n      } else {\r\n        // Considering minLength while edgescroll\r\n        let minLength = this.minLength;\r\n        if (!minLength) {\r\n          minLength = 0;\r\n        }\r\n\r\n        if (resize === 'start') {\r\n          if (time > this.end - minLength) {\r\n            time = this.end - minLength;\r\n            adjustment = scrollSpeed * scrollDirection;\r\n          }\r\n\r\n          if (time < 0) {\r\n            time = 0;\r\n          }\r\n        } else if (resize === 'end') {\r\n          if (time < this.start + minLength) {\r\n            time = this.start + minLength;\r\n            adjustment = scrollSpeed * scrollDirection;\r\n          }\r\n\r\n          if (time > duration) {\r\n            time = duration;\r\n          }\r\n        }\r\n      }\r\n\r\n      // Don't edgescroll if region has reached min or max limit\r\n      const wrapperScrollLeft = this.wrapper.scrollLeft;\r\n\r\n      if (scrollDirection === -1) {\r\n        if (Math.round(wrapperScrollLeft) === 0) {\r\n          return;\r\n        }\r\n\r\n        if (\r\n          Math.round(\r\n            wrapperScrollLeft -\r\n              regionHalfTimeWidth +\r\n              distanceBetweenCursorAndWrapperEdge\r\n          ) <= 0\r\n        ) {\r\n          return;\r\n        }\r\n      } else {\r\n        if (Math.round(wrapperScrollLeft) === maxScroll) {\r\n          return;\r\n        }\r\n\r\n        if (\r\n          Math.round(\r\n            wrapperScrollLeft +\r\n              regionHalfTimeWidth -\r\n              distanceBetweenCursorAndWrapperEdge\r\n          ) >= maxScroll\r\n        ) {\r\n          return;\r\n        }\r\n      }\r\n\r\n      // Update scroll position\r\n      let scrollLeft =\r\n        wrapperScrollLeft - adjustment + scrollSpeed * scrollDirection;\r\n\r\n      if (scrollDirection === -1) {\r\n        const calculatedLeft = Math.max(\r\n          0 + regionHalfTimeWidth - distanceBetweenCursorAndWrapperEdge,\r\n          scrollLeft\r\n        );\r\n        this.wrapper.scrollLeft = scrollLeft = calculatedLeft;\r\n      } else {\r\n        const calculatedRight = Math.min(\r\n          maxScroll - regionHalfTimeWidth + distanceBetweenCursorAndWrapperEdge,\r\n          scrollLeft\r\n        );\r\n        this.wrapper.scrollLeft = scrollLeft = calculatedRight;\r\n      }\r\n\r\n      const delta = time - startTime;\r\n      startTime = time;\r\n\r\n      // Continue dragging or resizing\r\n      drag ? this.onDrag(delta) : this.onResize(delta, resize);\r\n\r\n      // Repeat\r\n      window.requestAnimationFrame(() => {\r\n        edgeScroll(event);\r\n      });\r\n    };\r\n\r\n    const onDown = (event) => {\r\n      const duration = this.wavesurfer.getDuration();\r\n      if (event.touches && event.touches.length > 1) {\r\n        return;\r\n      }\r\n      touchId = event.targetTouches ? event.targetTouches[0].identifier : null;\r\n\r\n      // stop the event propagation, if this region is resizable or draggable\r\n      // and the event is therefore handled here.\r\n      if (this.drag || this.resize) {\r\n        event.stopPropagation();\r\n      }\r\n\r\n      // Store the selected startTime we begun dragging or resizing\r\n      startTime = this.regionsUtil.getRegionSnapToGridValue(\r\n        this.wavesurfer.drawer.handleEvent(event, true) * duration\r\n      );\r\n\r\n      // Store the selected point of contact when we begin dragging\r\n      regionLeftHalfTime = startTime - this.start;\r\n      regionRightHalfTime = this.end - startTime;\r\n\r\n      // Store for scroll calculations\r\n      maxScroll = this.wrapper.scrollWidth - this.wrapper.clientWidth;\r\n\r\n      wrapperRect = this.util.withOrientation(\r\n        this.wrapper.getBoundingClientRect(),\r\n        this.vertical\r\n      );\r\n\r\n      this.isResizing = false;\r\n      this.isDragging = false;\r\n      if (event.target.tagName.toLowerCase() === 'handle') {\r\n        this.isResizing = true;\r\n        resize = event.target.classList.contains('wavesurfer-handle-start')\r\n          ? 'start'\r\n          : 'end';\r\n      } else {\r\n        this.isDragging = true;\r\n        drag = true;\r\n        resize = false;\r\n      }\r\n    };\r\n    const onUp = (event) => {\r\n      if (event.touches && event.touches.length > 1) {\r\n        return;\r\n      }\r\n\r\n      if (drag || resize) {\r\n        this.isDragging = false;\r\n        this.isResizing = false;\r\n        drag = false;\r\n        scrollDirection = null;\r\n        resize = false;\r\n      }\r\n\r\n      if (updated) {\r\n        updated = false;\r\n        this.util.preventClick();\r\n        this.fireEvent('update-end', event);\r\n        this.wavesurfer.fireEvent('region-update-end', this, event);\r\n      }\r\n    };\r\n    const onMove = (event) => {\r\n      const duration = this.wavesurfer.getDuration();\r\n      let orientedEvent = this.util.withOrientation(event, this.vertical);\r\n\r\n      if (event.touches && event.touches.length > 1) {\r\n        return;\r\n      }\r\n      if (event.targetTouches && event.targetTouches[0].identifier != touchId) {\r\n        return;\r\n      }\r\n      if (!drag && !resize) {\r\n        return;\r\n      }\r\n\r\n      const oldTime = startTime;\r\n      let time = this.regionsUtil.getRegionSnapToGridValue(\r\n        this.wavesurfer.drawer.handleEvent(event) * duration\r\n      );\r\n\r\n      if (drag) {\r\n        // To maintain relative cursor start point while dragging\r\n        const maxEnd = this.wavesurfer.getDuration();\r\n        if (time > maxEnd - regionRightHalfTime) {\r\n          time = maxEnd - regionRightHalfTime;\r\n        }\r\n\r\n        if (time - regionLeftHalfTime < 0) {\r\n          time = regionLeftHalfTime;\r\n        }\r\n      }\r\n\r\n      if (resize) {\r\n        // To maintain relative cursor start point while resizing\r\n        // we have to handle for minLength\r\n        let minLength = this.minLength;\r\n        if (!minLength) {\r\n          minLength = 0;\r\n        }\r\n\r\n        if (resize === 'start') {\r\n          if (time > this.end - minLength) {\r\n            time = this.end - minLength;\r\n          }\r\n\r\n          if (time < 0) {\r\n            time = 0;\r\n          }\r\n        } else if (resize === 'end') {\r\n          if (time < this.start + minLength) {\r\n            time = this.start + minLength;\r\n          }\r\n\r\n          if (time > duration) {\r\n            time = duration;\r\n          }\r\n        }\r\n      }\r\n\r\n      let delta = time - startTime;\r\n      startTime = time;\r\n\r\n      // Drag\r\n      if (this.drag && drag) {\r\n        updated = updated || !!delta;\r\n        this.onDrag(delta);\r\n      }\r\n\r\n      // Resize\r\n      if (this.resize && resize) {\r\n        updated = updated || !!delta;\r\n        this.onResize(delta, resize);\r\n      }\r\n\r\n      if (this.scroll && container.clientWidth < this.wrapper.scrollWidth) {\r\n        // Triggering edgescroll from within edgeScrollWidth\r\n        let x = orientedEvent.clientX;\r\n\r\n        // Check direction\r\n        if (x < wrapperRect.left + this.edgeScrollWidth) {\r\n          scrollDirection = -1;\r\n        } else if (x > wrapperRect.right - this.edgeScrollWidth) {\r\n          scrollDirection = 1;\r\n        } else {\r\n          scrollDirection = null;\r\n        }\r\n\r\n        if (scrollDirection) {\r\n          edgeScroll(event);\r\n        }\r\n      }\r\n    };\r\n\r\n    this.element.addEventListener('mousedown', onDown);\r\n    this.element.addEventListener('touchstart', onDown);\r\n\r\n    document.body.addEventListener('mousemove', onMove);\r\n    document.body.addEventListener('touchmove', onMove, { passive: false });\r\n\r\n    document.addEventListener('mouseup', onUp);\r\n    document.body.addEventListener('touchend', onUp);\r\n\r\n    this.on('remove', () => {\r\n      document.removeEventListener('mouseup', onUp);\r\n      document.body.removeEventListener('touchend', onUp);\r\n      document.body.removeEventListener('mousemove', onMove);\r\n      document.body.removeEventListener('touchmove', onMove);\r\n    });\r\n\r\n    this.wavesurfer.on('destroy', () => {\r\n      document.removeEventListener('mouseup', onUp);\r\n      document.body.removeEventListener('touchend', onUp);\r\n    });\r\n  }\r\n\r\n  onDrag(delta) {\r\n    const maxEnd = this.wavesurfer.getDuration();\r\n    if (this.end + delta > maxEnd) {\r\n      delta = maxEnd - this.end;\r\n    }\r\n\r\n    if (this.start + delta < 0) {\r\n      delta = this.start * -1;\r\n    }\r\n\r\n    const eventParams = {\r\n      direction: this._getDragDirection(delta),\r\n      action: 'drag',\r\n    };\r\n\r\n    this.update(\r\n      {\r\n        start: this.start + delta,\r\n        end: this.end + delta,\r\n      },\r\n      eventParams\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Returns the direction of dragging region based on delta\r\n   * Negative delta means region is moving to the left\r\n   * Positive - to the right\r\n   * For zero delta the direction is not defined\r\n   * @param {number} delta Drag offset\r\n   * @returns {string|null} Direction 'left', 'right' or null\r\n   */\r\n  _getDragDirection(delta) {\r\n    if (delta < 0) {\r\n      return 'left';\r\n    }\r\n    if (delta > 0) {\r\n      return 'right';\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * @example\r\n   * onResize(-5, 'start') // Moves the start point 5 seconds back\r\n   * onResize(0.5, 'end') // Moves the end point 0.5 seconds forward\r\n   *\r\n   * @param {number} delta How much to add or subtract, given in seconds\r\n   * @param {string} direction 'start 'or 'end'\r\n   */\r\n  onResize(delta, direction) {\r\n    const duration = this.wavesurfer.getDuration();\r\n    const eventParams = {\r\n      action: 'resize',\r\n      direction: direction === 'start' ? 'left' : 'right',\r\n    };\r\n\r\n    if (direction === 'start') {\r\n      // Check if changing the start by the given delta would result in the region being smaller than minLength\r\n      if (delta > 0 && this.end - (this.start + delta) < this.minLength) {\r\n        delta = this.end - this.minLength - this.start;\r\n      }\r\n\r\n      // Check if changing the start by the given delta would result in the region being larger than maxLength\r\n      if (delta < 0 && this.end - (this.start + delta) > this.maxLength) {\r\n        delta = this.end - this.start - this.maxLength;\r\n      }\r\n\r\n      if (delta < 0 && this.start + delta < 0) {\r\n        delta = this.start * -1;\r\n      }\r\n\r\n      this.update(\r\n        {\r\n          start: Math.min(this.start + delta, this.end),\r\n          end: Math.max(this.start + delta, this.end),\r\n        },\r\n        eventParams\r\n      );\r\n    } else {\r\n      // Check if changing the end by the given delta would result in the region being smaller than minLength\r\n      if (delta < 0 && this.end + delta - this.start < this.minLength) {\r\n        delta = this.start + this.minLength - this.end;\r\n      }\r\n\r\n      // Check if changing the end by the given delta would result in the region being larger than maxLength\r\n      if (delta > 0 && this.end + delta - this.start > this.maxLength) {\r\n        delta = this.maxLength - (this.end - this.start);\r\n      }\r\n\r\n      if (delta > 0 && this.end + delta > duration) {\r\n        delta = duration - this.end;\r\n      }\r\n\r\n      this.update(\r\n        {\r\n          start: Math.min(this.end + delta, this.start),\r\n          end: Math.max(this.end + delta, this.start),\r\n        },\r\n        eventParams\r\n      );\r\n    }\r\n  }\r\n\r\n  updateHandlesResize(resize) {\r\n    let cursorStyle;\r\n    if (resize) {\r\n      cursorStyle = this.vertical ? 'row-resize' : 'col-resize';\r\n    } else {\r\n      cursorStyle = 'auto';\r\n    }\r\n\r\n    this.handleLeftEl && this.style(this.handleLeftEl, { cursor: cursorStyle });\r\n    this.handleRightEl &&\r\n      this.style(this.handleRightEl, { cursor: cursorStyle });\r\n  }\r\n}\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\r\n *  @since 4.0.0 This class has been split\r\n *\r\n * @typedef {Object} RegionsPluginParams\r\n * @property {?boolean} dragSelection Enable creating regions by dragging with\r\n * the mouse\r\n * @property {?RegionParams[]} regions Regions that should be added upon\r\n * initialisation\r\n * @property {number} slop=2 The sensitivity of the mouse dragging\r\n * @property {?number} snapToGridInterval Snap the regions to a grid of the specified multiples in seconds\r\n * @property {?number} snapToGridOffset Shift the snap-to-grid by the specified seconds. May also be negative.\r\n * @property {?boolean} deferInit Set to true to manually call\r\n * @property {number} maxRegions Maximum number of regions that may be created by the user at one time.\r\n * `initPlugin('regions')`\r\n * @property {function} formatTimeCallback Allows custom formating for region tooltip.\r\n * @property {?number} edgeScrollWidth='5% from container edges' Optional width for edgeScroll to start\r\n */\r\n\r\n/**\r\n * @typedef {Object} RegionParams\r\n * @desc The parameters used to describe a region.\r\n * @example wavesurfer.addRegion(regionParams);\r\n * @property {string} id=→random The id of the region\r\n * @property {number} start=0 The start position of the region (in seconds).\r\n * @property {number} end=0 The end position of the region (in seconds).\r\n * @property {?boolean} loop Whether to loop the region when played back.\r\n * @property {boolean} drag=true Allow/disallow dragging the region.\r\n * @property {boolean} resize=true Allow/disallow resizing the region.\r\n * @property {string} [color='rgba(0, 0, 0, 0.1)'] HTML color code.\r\n * @property {?number} channelIdx Select channel to draw the region on (if there are multiple channel waveforms).\r\n * @property {?object} handleStyle A set of CSS properties used to style the left and right handle.\r\n * @property {?boolean} preventContextMenu=false Determines whether the context menu is prevented from being opened.\r\n * @property {boolean} showTooltip=true Enable/disable tooltip displaying start and end times when hovering over region.\r\n */\r\n\r\nimport {Region} from \"./region.js\";\r\n\r\n/**\r\n * Regions are visual overlays on waveform that can be used to play and loop\r\n * portions of audio. Regions can be dragged and resized.\r\n *\r\n * Visual customization is possible via CSS (using the selectors\r\n * `.wavesurfer-region` and `.wavesurfer-handle`).\r\n *\r\n * @implements {PluginClass}\r\n * @extends {Observer}\r\n *\r\n * @example\r\n * // es6\r\n * import RegionsPlugin from 'wavesurfer.regions.js';\r\n *\r\n * // commonjs\r\n * var RegionsPlugin = require('wavesurfer.regions.js');\r\n *\r\n * // if you are using <script> tags\r\n * var RegionsPlugin = window.WaveSurfer.regions;\r\n *\r\n * // ... initialising wavesurfer with the plugin\r\n * var wavesurfer = WaveSurfer.create({\r\n *   // wavesurfer options ...\r\n *   plugins: [\r\n *     RegionsPlugin.create({\r\n *       // plugin options ...\r\n *     })\r\n *   ]\r\n * });\r\n */\r\nexport default class RegionsPlugin {\r\n    /**\r\n     * Regions plugin definition factory\r\n     *\r\n     * This function must be used to create a plugin definition which can be\r\n     * used by wavesurfer to correctly instantiate the plugin.\r\n     *\r\n     * @param {RegionsPluginParams} params parameters use to initialise the plugin\r\n     * @return {PluginDefinition} an object representing the plugin\r\n     */\r\n    static create(params) {\r\n        return {\r\n            name: 'regions',\r\n            deferInit: params && params.deferInit ? params.deferInit : false,\r\n            params: params,\r\n            staticProps: {\r\n                addRegion(options) {\r\n                    if (!this.initialisedPluginList.regions) {\r\n                        this.initPlugin('regions');\r\n                    }\r\n                    return this.regions.add(options);\r\n                },\r\n\r\n                clearRegions() {\r\n                    this.regions && this.regions.clear();\r\n                },\r\n\r\n                enableDragSelection(options) {\r\n                    if (!this.initialisedPluginList.regions) {\r\n                        this.initPlugin('regions');\r\n                    }\r\n                    this.regions.enableDragSelection(options);\r\n                },\r\n\r\n                disableDragSelection() {\r\n                    this.regions.disableDragSelection();\r\n                }\r\n            },\r\n            instance: RegionsPlugin\r\n        };\r\n    }\r\n\r\n    constructor(params, ws) {\r\n        this.params = params;\r\n        this.wavesurfer = ws;\r\n        this.util = {\r\n            ...ws.util,\r\n            getRegionSnapToGridValue: value => {\r\n                return this.getRegionSnapToGridValue(value, params);\r\n            }\r\n        };\r\n        this.maxRegions = params.maxRegions;\r\n        this.regionsMinLength = params.regionsMinLength || null;\r\n\r\n        // turn the plugin instance into an observer\r\n        const observerPrototypeKeys = Object.getOwnPropertyNames(\r\n            this.util.Observer.prototype\r\n        );\r\n        observerPrototypeKeys.forEach(key => {\r\n            Region.prototype[key] = this.util.Observer.prototype[key];\r\n        });\r\n        this.wavesurfer.Region = Region;\r\n\r\n        // By default, scroll the container if the user drags a region\r\n        // within 5% (based on its initial size) of its edge\r\n        const scrollWidthProportion = 0.05;\r\n        this._onBackendCreated = () => {\r\n            this.wrapper = this.wavesurfer.drawer.wrapper;\r\n            this.orientation = this.wavesurfer.drawer.orientation;\r\n            this.defaultEdgeScrollWidth = this.wrapper.clientWidth * scrollWidthProportion;\r\n            if (this.params.regions) {\r\n                this.params.regions.forEach(region => {\r\n                    this.add(region);\r\n                });\r\n            }\r\n        };\r\n\r\n        // Id-based hash of regions\r\n        this.list = {};\r\n        this._onReady = () => {\r\n            this.wrapper = this.wavesurfer.drawer.wrapper;\r\n            this.vertical = this.wavesurfer.drawer.params.vertical;\r\n            if (this.params.dragSelection) {\r\n                this.enableDragSelection(this.params);\r\n            }\r\n            Object.keys(this.list).forEach(id => {\r\n                this.list[id].updateRender();\r\n            });\r\n        };\r\n    }\r\n\r\n    init() {\r\n        // Check if ws is ready\r\n        if (this.wavesurfer.isReady) {\r\n            this._onBackendCreated();\r\n            this._onReady();\r\n        } else {\r\n            this.wavesurfer.once('ready', this._onReady);\r\n            this.wavesurfer.once('backend-created', this._onBackendCreated);\r\n        }\r\n    }\r\n\r\n    destroy() {\r\n        this.wavesurfer.un('ready', this._onReady);\r\n        this.wavesurfer.un('backend-created', this._onBackendCreated);\r\n        // Disabling `region-removed' because destroying the plugin calls\r\n        // the Region.remove() method that is also used to remove regions based\r\n        // on user input. This can cause confusion since teardown is not a\r\n        // user event, but would emit `region-removed` as if it was.\r\n        this.wavesurfer.setDisabledEventEmissions(['region-removed']);\r\n        this.disableDragSelection();\r\n        this.clear();\r\n    }\r\n\r\n    /**\r\n     * check to see if adding a new region would exceed maxRegions\r\n     * @return {boolean} whether we should proceed and create a region\r\n     * @private\r\n     */\r\n    wouldExceedMaxRegions() {\r\n        return (\r\n            this.maxRegions && Object.keys(this.list).length >= this.maxRegions\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Add a region\r\n     *\r\n     * @param {object} params Region parameters\r\n     * @return {Region} The created region\r\n     */\r\n    add(params) {\r\n        if (this.wouldExceedMaxRegions()) {\r\n            return null;\r\n        }\r\n\r\n        params = {\r\n            edgeScrollWidth: this.params.edgeScrollWidth || this.defaultEdgeScrollWidth,\r\n            ...params\r\n        };\r\n\r\n        // Take formatTimeCallback from plugin params if not already set\r\n        if (!params.formatTimeCallback && this.params.formatTimeCallback) {\r\n            params = {...params, formatTimeCallback: this.params.formatTimeCallback};\r\n        }\r\n\r\n        if (!params.minLength && this.regionsMinLength) {\r\n            params = {...params, minLength: this.regionsMinLength};\r\n        }\r\n\r\n        const region = new this.wavesurfer.Region(params, this.util, this.wavesurfer);\r\n\r\n        this.list[region.id] = region;\r\n\r\n        region.on('remove', () => {\r\n            delete this.list[region.id];\r\n        });\r\n\r\n        return region;\r\n    }\r\n\r\n    /**\r\n     * Remove all regions\r\n     */\r\n    clear() {\r\n        Object.keys(this.list).forEach(id => {\r\n            this.list[id].remove();\r\n        });\r\n    }\r\n\r\n    enableDragSelection(params) {\r\n        this.disableDragSelection();\r\n\r\n        const slop = params.slop || 2;\r\n        const container = this.wavesurfer.drawer.container;\r\n        const scroll =\r\n            params.scroll !== false && this.wavesurfer.params.scrollParent;\r\n        const scrollSpeed = params.scrollSpeed || 1;\r\n        const scrollThreshold = params.scrollThreshold || 10;\r\n        let drag;\r\n        let duration = this.wavesurfer.getDuration();\r\n        let maxScroll;\r\n        let start;\r\n        let region;\r\n        let touchId;\r\n        let pxMove = 0;\r\n        let scrollDirection;\r\n        let wrapperRect;\r\n\r\n        // Scroll when the user is dragging within the threshold\r\n        const edgeScroll = e => {\r\n            if (!region || !scrollDirection) {\r\n                return;\r\n            }\r\n\r\n            // Update scroll position\r\n            let scrollLeft =\r\n                this.wrapper.scrollLeft + scrollSpeed * scrollDirection;\r\n            this.wrapper.scrollLeft = scrollLeft = Math.min(\r\n                maxScroll,\r\n                Math.max(0, scrollLeft)\r\n            );\r\n\r\n            // Update range\r\n            const end = this.wavesurfer.drawer.handleEvent(e);\r\n            region.update({\r\n                start: Math.min(end * duration, start * duration),\r\n                end: Math.max(end * duration, start * duration)\r\n            });\r\n\r\n            // Check that there is more to scroll and repeat\r\n            if (scrollLeft < maxScroll && scrollLeft > 0) {\r\n                window.requestAnimationFrame(() => {\r\n                    edgeScroll(e);\r\n                });\r\n            }\r\n        };\r\n\r\n        const eventDown = e => {\r\n            if (e.touches && e.touches.length > 1) {\r\n                return;\r\n            }\r\n            duration = this.wavesurfer.getDuration();\r\n            touchId = e.targetTouches ? e.targetTouches[0].identifier : null;\r\n\r\n            // Store for scroll calculations\r\n            maxScroll = this.wrapper.scrollWidth -\r\n                this.wrapper.clientWidth;\r\n            wrapperRect = this.util.withOrientation(\r\n                this.wrapper.getBoundingClientRect(),\r\n                this.vertical\r\n            );\r\n\r\n            // set the region channel index based on the clicked area\r\n            if (this.wavesurfer.params.splitChannels) {\r\n                const y = (e.touches ? e.touches[0].clientY : e.clientY) - wrapperRect.top;\r\n                const channelCount = params.countChannels ? params.countChannels :\r\n                    this.wavesurfer.backend.buffer != null ? this.wavesurfer.backend.buffer.numberOfChannels : 1;\r\n                const channelHeight = this.wrapper.clientHeight / channelCount;\r\n                const channelIdx = Math.floor(y / channelHeight);\r\n\r\n                if (params.selectableChannelId !== undefined && channelIdx !== params.selectableChannelId) {\r\n                    return;\r\n                }\r\n\r\n                params.channelIdx = channelIdx;\r\n                const channelColors = this.wavesurfer.params.splitChannelsOptions.channelColors[channelIdx];\r\n                if (channelColors && channelColors.dragColor) {\r\n                    params.color = channelColors.dragColor;\r\n                }\r\n            }\r\n\r\n            drag = true;\r\n            start = this.wavesurfer.drawer.handleEvent(e, true);\r\n            region = null;\r\n            scrollDirection = null;\r\n        };\r\n        this.wrapper.addEventListener('mousedown', eventDown);\r\n        this.wrapper.addEventListener('touchstart', eventDown);\r\n        this.on('disable-drag-selection', () => {\r\n            this.wrapper.removeEventListener('touchstart', eventDown);\r\n            this.wrapper.removeEventListener('mousedown', eventDown);\r\n        });\r\n\r\n        const eventUp = e => {\r\n            if (e.touches && e.touches.length > 1) {\r\n                return;\r\n            }\r\n\r\n            drag = false;\r\n            pxMove = 0;\r\n            scrollDirection = null;\r\n\r\n            if (region) {\r\n                this.util.preventClick();\r\n                region.fireEvent('update-end', e);\r\n                this.wavesurfer.fireEvent('region-update-end', region, e);\r\n            }\r\n\r\n            region = null;\r\n        };\r\n        this.wrapper.addEventListener('mouseleave', eventUp);\r\n        this.wrapper.addEventListener('mouseup', eventUp);\r\n        this.wrapper.addEventListener('touchend', eventUp);\r\n\r\n        document.body.addEventListener('mouseup', eventUp);\r\n        document.body.addEventListener('touchend', eventUp);\r\n        this.on('disable-drag-selection', () => {\r\n            document.body.removeEventListener('mouseup', eventUp);\r\n            document.body.removeEventListener('touchend', eventUp);\r\n            this.wrapper.removeEventListener('touchend', eventUp);\r\n            this.wrapper.removeEventListener('mouseup', eventUp);\r\n            this.wrapper.removeEventListener('mouseleave', eventUp);\r\n        });\r\n\r\n        const eventMove = event => {\r\n            if (!drag) {\r\n                return;\r\n            }\r\n            if (++pxMove <= slop) {\r\n                return;\r\n            }\r\n\r\n            if (event.touches && event.touches.length > 1) {\r\n                return;\r\n            }\r\n            if (event.targetTouches && event.targetTouches[0].identifier != touchId) {\r\n                return;\r\n            }\r\n\r\n            // auto-create a region during mouse drag, unless region-count would exceed \"maxRegions\"\r\n            if (!region) {\r\n                region = this.add(params || {});\r\n                if (!region) {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            const end = this.wavesurfer.drawer.handleEvent(event);\r\n            const startUpdate = this.wavesurfer.regions.util.getRegionSnapToGridValue(\r\n                start * duration\r\n            );\r\n            const endUpdate = this.wavesurfer.regions.util.getRegionSnapToGridValue(\r\n                end * duration\r\n            );\r\n            region.update({\r\n                start: Math.min(endUpdate, startUpdate),\r\n                end: Math.max(endUpdate, startUpdate)\r\n            });\r\n\r\n            let orientedEvent = this.util.withOrientation(event, this.vertical);\r\n\r\n            // If scrolling is enabled\r\n            if (scroll && container.clientWidth < this.wrapper.scrollWidth) {\r\n                // Check threshold based on mouse\r\n                const x = orientedEvent.clientX - wrapperRect.left;\r\n                if (x <= scrollThreshold) {\r\n                    scrollDirection = -1;\r\n                } else if (x >= wrapperRect.right - scrollThreshold) {\r\n                    scrollDirection = 1;\r\n                } else {\r\n                    scrollDirection = null;\r\n                }\r\n                scrollDirection && edgeScroll(event);\r\n            }\r\n        };\r\n        this.wrapper.addEventListener('mousemove', eventMove);\r\n        this.wrapper.addEventListener('touchmove', eventMove);\r\n        this.on('disable-drag-selection', () => {\r\n            this.wrapper.removeEventListener('touchmove', eventMove);\r\n            this.wrapper.removeEventListener('mousemove', eventMove);\r\n        });\r\n\r\n        this.wavesurfer.on('region-created', region => {\r\n            if (this.regionsMinLength) {\r\n                region.minLength = this.regionsMinLength;\r\n            }\r\n        });\r\n    }\r\n\r\n    disableDragSelection() {\r\n        this.fireEvent('disable-drag-selection');\r\n    }\r\n\r\n    /**\r\n     * Get current region\r\n     *\r\n     * The smallest region that contains the current time. If several such\r\n     * regions exist, take the first. Return `null` if none exist.\r\n     *\r\n     * @returns {Region} The current region\r\n     */\r\n    getCurrentRegion() {\r\n        const time = this.wavesurfer.getCurrentTime();\r\n        let min = null;\r\n        Object.keys(this.list).forEach(id => {\r\n            const cur = this.list[id];\r\n            if (cur.start <= time && cur.end >= time) {\r\n                if (!min || cur.end - cur.start < min.end - min.start) {\r\n                    min = cur;\r\n                }\r\n            }\r\n        });\r\n\r\n        return min;\r\n    }\r\n\r\n    /**\r\n     * Match the value to the grid, if required\r\n     *\r\n     * If the regions plugin params have a snapToGridInterval set, return the\r\n     * value matching the nearest grid interval. If no snapToGridInterval is set,\r\n     * the passed value will be returned without modification.\r\n     *\r\n     * @param {number} value the value to snap to the grid, if needed\r\n     * @param {Object} params the regions plugin params\r\n     * @returns {number} value\r\n     */\r\n    getRegionSnapToGridValue(value, params) {\r\n        if (params.snapToGridInterval) {\r\n            // the regions should snap to a grid\r\n            const offset = params.snapToGridOffset || 0;\r\n            return (\r\n                Math.round((value - offset) / params.snapToGridInterval) *\r\n                    params.snapToGridInterval +\r\n                offset\r\n            );\r\n        }\r\n\r\n        // no snap-to-grid\r\n        return value;\r\n    }\r\n}\r\n"],"names":["Region","constructor","params","regionsUtils","ws","wavesurfer","wrapper","drawer","util","style","regionsUtil","vertical","id","getId","start","Number","end","scrollWidth","getDuration","resize","undefined","Boolean","drag","isResizing","isDragging","loop","color","handleStyle","left","right","handleLeftEl","handleRightEl","data","attributes","showTooltip","maxLength","minLength","_onRedraw","updateRender","scroll","scrollParent","scrollSpeed","scrollThreshold","preventContextMenu","channelIdx","parseInt","channelCount","regions","splitChannels","regionHeight","marginTop","Math","floor","getHeight","formatTimeCallback","edgeScrollWidth","bindInOut","render","on","fireEvent","update","eventParams","updateHandlesResize","remove","element","removeChild","domElement","un","play","s","playLoop","setLoop","withOrientation","appendChild","document","createElement","className","title","formatTime","setAttribute","attrname","position","height","top","css","cursor","width","backgroundColor","handleLeftCss","Object","assign","handleRightCss","bindEvents","map","time","slice","join","getWidth","pixelRatio","dur","startLimited","endLimited","max","min","round","regionWidth","firedIn","firedOut","onProcess","backend","realTime","getCurrentTime","addEventListener","e","preventDefault","stopPropagation","bindDragEvents","container","startTime","touchId","maxScroll","updated","scrollDirection","wrapperRect","regionLeftHalfTime","regionRightHalfTime","edgeScroll","event","orientedEvent","duration","x","clientX","distanceBetweenCursorAndWrapperEdge","regionHalfTimeWidth","adjustment","getRegionSnapToGridValue","handleEvent","minPxPerSec","wrapperScrollLeft","scrollLeft","calculatedLeft","calculatedRight","delta","onDrag","onResize","window","requestAnimationFrame","onDown","touches","length","targetTouches","identifier","clientWidth","getBoundingClientRect","target","tagName","toLowerCase","classList","contains","onUp","preventClick","onMove","oldTime","maxEnd","body","passive","removeEventListener","direction","_getDragDirection","action","cursorStyle","RegionsPlugin","create","name","deferInit","staticProps","addRegion","options","initialisedPluginList","initPlugin","add","clearRegions","clear","enableDragSelection","disableDragSelection","instance","value","maxRegions","regionsMinLength","observerPrototypeKeys","getOwnPropertyNames","Observer","prototype","forEach","key","scrollWidthProportion","_onBackendCreated","orientation","defaultEdgeScrollWidth","region","list","_onReady","dragSelection","keys","init","isReady","once","destroy","setDisabledEventEmissions","wouldExceedMaxRegions","slop","pxMove","eventDown","y","clientY","countChannels","buffer","numberOfChannels","channelHeight","clientHeight","selectableChannelId","channelColors","splitChannelsOptions","dragColor","eventUp","eventMove","startUpdate","endUpdate","getCurrentRegion","cur","snapToGridInterval","offset","snapToGridOffset"],"sourceRoot":""}